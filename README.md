# Secure Vote Chain DApp

このDAppは、ブロックチェーン技術を活用して、より透明で改ざん耐性のある投票システムを構築することを目指しています。従来の投票システムが抱える「管理者による投票改ざん」や「有権者による二重投票」といった課題に対し、ブロックチェーンの分散性、不変性、透明性によって解決を図ります。

本プロジェクトは、デモ目的で主要機能を実装しています。

## 機能概要

* **選挙管理委員会 (Admin)**:
    * 候補者の立候補承認・不承認。
* **有権者 (Voter)**:
    * 有権者情報の登録。
    * 候補者への投票（居住市と一致する候補者への一度きりの投票）。
    * 有権者から候補者へのロール変更（立候補）。
* **候補者 (Candidate)**:
    * 有権者からの立候補によって登録。
    * 選挙管理委員会による承認が必要。
* **投票記録**:
    * すべての投票がブロックチェーン上に記録され、追跡可能。

## 実装されている主な機能

* **`add_infor(address _addr, string _name, string _city)`**:
    * 指定されたアドレスの有権者情報を登録します。`msg.sender`が`_addr`である必要があります。
    * 新規登録の場合、そのアドレスを内部的に管理する`voterAddresses`リストに追加します。
* **`become_candidate(address _addr, string _city, string _party)`**:
    * 有権者が候補者になるための関数です。
    * `_addr`のロールを`CANDIDATE`に変更し、候補者情報を登録します。元の有権者情報は削除されます。
    * **注意**: `become_candidate`実行後も、`getAllVotersInfo`で返されるリストに旧有権者のアドレスが含まれる可能性があります（詳細な削除ロジックが未実装のため）。
* **`vote(address _addr, address _candidate_addr, string _city)`**:
    * 指定された候補者へ投票します。
    * 投票には、本人確認、有権者ロールであること、未投票であること、候補者が承認済みであること、有権者の居住市と候補者の居住市が一致することなど、複数の条件があります。
* **`getAllVotersInfo()`**:
    * 現在登録されている**すべての有権者**の情報を一括で取得します。
    * 返される情報: アドレス、名前、ロール（0: 有権者, 1: 候補者）、ロール承認状態、居住市、投票済みフラグ。
    * この関数は、デモ時間を短縮し、登録済みの全有権者情報を手軽に確認できるようにするために追加されました。

## 技術スタック

* **Solidity `^0.4.24`**: スマートコントラクトの記述言語。
* **`pragma experimental ABIEncoderV2;`**: 複数の動的配列を返すために使用。

## 開発環境での利用方法

1.  **Remix IDE の利用を推奨します。**
2.  SolidityコードをRemixに貼り付け、コンパイルします。
3.  デプロイ（例: JavaScript VM環境やテストネット）。
4.  コントラクトの各関数を呼び出し、DAppの機能を試してください。
    * 最初に`add_infor`でいくつかのアドレスを有権者として登録します。
    * `getAllVotersInfo()`を呼び出して、登録された有権者リストを確認します。
    * 必要に応じて`become_candidate`や`vote`を試してください。